var t=Object.create;var{getPrototypeOf:B,defineProperty:p,getOwnPropertyNames:q}=Object;var z=Object.prototype.hasOwnProperty;var F=(s,c,r)=>{r=s!=null?t(B(s)):{};let m=c||!s||!s.__esModule?p(r,"default",{value:s,enumerable:!0}):r;for(let u of q(s))if(!z.call(m,u))p(m,u,{get:()=>s[u],enumerable:!0});return m};var G=(s,c)=>()=>(c||s((c={exports:{}}).exports,c),c.exports);var H=((s)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(s,{get:(c,r)=>(typeof require!=="undefined"?require:c)[r]}):s)(function(s){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+s+'" is not supported')});var T=G((R,x)=>{var g=(()=>({})),o={asyncWrite:!1,syncOnWrite:!0,jsonSpaces:4,stringify:JSON.stringify,parse:JSON.parse},K=function(s){try{this.options.parse(s)}catch(c){throw console.error("Given filePath is not empty and its content is not valid JSON."),c}return!0};function n(s,c){if(!s||!s.length)throw new Error("Missing file path argument.");else this.filePath=s;if(c){for(let m in o)if(!c.hasOwnProperty(m))c[m]=o[m];this.options=c}else this.options=o;this.storage={};let r;try{r=g.statSync(s)}catch(m){if(m.code==="ENOENT")return;else if(m.code==="EACCES")throw new Error(`Cannot access path "${s}".`);else throw new Error(`Error while checking for existence of path "${s}": ${m}`)}try{g.accessSync(s,g.constants.R_OK|g.constants.W_OK)}catch(m){throw new Error(`Cannot read & write on path "${s}". Check permissions!`)}if(r.size>0){let m;try{m=g.readFileSync(s)}catch(u){throw u}if(K.bind(this)(m))this.storage=this.options.parse(m)}}n.prototype.set=function(s,c){if(this.storage[s]=c,this.options&&this.options.syncOnWrite)this.sync()};n.prototype.get=function(s){return this.storage.hasOwnProperty(s)?this.storage[s]:void 0};n.prototype.has=function(s){return this.storage.hasOwnProperty(s)};n.prototype.delete=function(s){let c=this.storage.hasOwnProperty(s)?delete this.storage[s]:void 0;if(this.options&&this.options.syncOnWrite)this.sync();return c};n.prototype.deleteAll=function(){for(var s in this.storage)this.delete(s);return this};n.prototype.sync=function(){if(this.options&&this.options.asyncWrite)g.writeFile(this.filePath,this.options.stringify(this.storage,null,this.options.jsonSpaces),(s)=>{if(s)throw s});else try{g.writeFileSync(this.filePath,this.options.stringify(this.storage,null,this.options.jsonSpaces))}catch(s){if(s.code==="EACCES")throw new Error(`Cannot access path "${this.filePath}".`);else throw new Error(`Error while writing to path "${this.filePath}": ${s}`)}};n.prototype.JSON=function(s){if(s)try{JSON.parse(this.options.stringify(s)),this.storage=s}catch(c){throw new Error("Given parameter is not a valid JSON object.")}return JSON.parse(this.options.stringify(this.storage))};x.exports=n});var d=F(T(),1),e=new d.default("./otp.json");var D=(s,c=4,r=10)=>{let m=Math.floor(Math.pow(10,c-1)+Math.random()*9*Math.pow(10,c-1)).toString(),u={otp:Number(m),expire:new Date(Date.now()+r*60*1000),phone:s};return e.set(s,u),console.log(u),{success:!0,message:"OTP generated successfully",data:u}};var M=(s)=>{return e.get(s)||null};var w=(s,c)=>{let r=M(s);if(!r)return{success:!1,message:"OTP code not found",arMessage:"لم يتم العثور على رمز التأكيد"};let m=new Date,u=new Date(r.expire);if(r?.otp&&u<m)return e.delete(s),{success:!1,message:"OTP code has expired",arMessage:"تم انتهاء صلاحية رمز التأكيد"};if(r?.otp&&Number(r.otp)===Number(c))return e.delete(s),{success:!0,message:"OTP code verified successfully",arMessage:"تم التحقق من رمز التأكيد بنجاح"};if(Number(r.otp.toString().split("").reverse().join(""))===Number(c))return e.delete(s),{success:!0,message:"OTP code verified successfully",arMessage:"تم التحقق من رمز التأكيد بنجاح"};if(r?.otp&&Number(r.otp)!==Number(c))return{success:!1,message:"Incorrect OTP",arMessage:"رمز التأكيد غير صحيح"};return{success:!1,message:"OTP code not found",arMessage:"حدث خطأ في التحقق من رمز التأكيد"}};var L={generate:D,verify:w,get:M},j=L;export{j as default};
