function c(t){return{generate(s,r=4,e=10){let u=Math.floor(Math.pow(10,r-1)+Math.random()*9*Math.pow(10,r-1)).toString(),a={otp:Number(u),expire:new Date(Date.now()+e*60*1000),phone:s};return t.set(s,a),{success:!0,message:"OTP generated successfully",data:a}},verify(s,r){let e=t.get(s);if(!e)return{success:!1,message:"OTP code not found",arMessage:"لم يتم العثور على رمز التأكيد"};let u=new Date,a=new Date(e.expire);if(e?.otp&&a<u)return t.delete(s),{success:!1,message:"OTP code has expired",arMessage:"تم انتهاء صلاحية رمز التأكيد"};if(e?.otp&&Number(e.otp)===Number(r))return t.delete(s),{success:!0,message:"OTP code verified successfully",arMessage:"تم التحقق من رمز التأكيد بنجاح"};if(Number(e.otp.toString().split("").reverse().join(""))===Number(r))return t.delete(s),{success:!0,message:"OTP code verified successfully",arMessage:"تم التحقق من رمز التأكيد بنجاح"};if(e?.otp&&Number(e.otp)!==Number(r))return{success:!1,message:"Incorrect OTP",arMessage:"رمز التأكيد غير صحيح"};return{success:!1,message:"OTP code not found",arMessage:"حدث خطأ في التحقق من رمز التأكيد"}}}}export{c as init};
